# CVE-2022-32168 - DLL Hijacking in Notepad++

## Description

CVE-2022-32168 is a DLL Hijacking vulnerability in Notepad++. This vulnerability allows an attacker to load a malicious DLL file (UxTheme.dll) to gain unauthorized code execution by placing the DLL in the same directory as the Notepad++ executable.

## Credit

I have not been able to find the author of this CVE to credit him.

## Requirements
- Notepad++ version 8.4.1 and before
- Windows OS
- Visual Studio (or any other tool to compile the DLL)

## Installation
- Download and install Notepad++ 8.4.1 from the official website

## Exploit
1. Download and extract the repository files
2. Compile the provided `UxTheme.dll` using Visual Studio with Additionnal Dependencies (Netapi32.lib;User32.lib)
3. Two options: trigger an AlertBox to validate the vulnerability, or create a user and add him to the local administrator group.
4. Move the DLL to the Notepad++ executable directory
5. Run Notepad++, the malicious DLL will be loaded, leading to code execution.
6. Profit! :)

## PoC

### AlertBox
AlertBox to validate vulnerability

![](https://github.com/luksecurity/securitystuff/blob/main/exploits/thick%20client/notepad%2B%2B/CVE-2022-32168/static/poc-alert.png)

### Add a user and place him in the local admin group
Create `user_poc` user and add to local admin group

![](https://github.com/luksecurity/securitystuff/blob/main/exploits/thick%20client/notepad%2B%2B/CVE-2022-32168/static/poc-adduser.png)

## Mitigation
To mitigate this vulnerability, upgrade to Notepad++ version 8.4.5 or later, which resolves the issue by ensuring proper DLL path handling.

## Disclaimer
This project is intended for educational purposes only. The author is not responsible for any misuse of this information.

## References
- [CVE-2022-32168 - NVD Database](https://nvd.nist.gov/vuln/detail/CVE-2022-32168)
- [Fixes security vulnerability](https://github.com/notepad-plus-plus/notepad-plus-plus/commit/85d7215d9b3e0d5a8433fc31aec4f2966821051e)
